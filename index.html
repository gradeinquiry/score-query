<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>成績查詢系統</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <style>
        body { background-color: #f8f9fa; font-family: "Microsoft JhengHei", sans-serif; }
        .query-card { max-width: 450px; margin: 50px auto; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border: none; }
        .card-header { background: #1e3a8a; color: white; text-align: center; padding: 25px; border-radius: 15px 15px 0 0 !important; }
        .result-box { display: none; margin-top: 20px; }
    </style>
</head>
<body>

<div class="container">
    <div class="card query-card">
        <div class="card-header"><h4>正式成績查詢</h4></div>
        <div class="card-body p-4">
            <div class="mb-3">
                <label class="form-label fw-bold">帳號 (合併准考證號)</label>
                <input type="text" id="userInput" class="form-control" placeholder="請輸入合併號碼">
            </div>
            <div class="mb-4">
                <label class="form-label fw-bold">密碼 (手機末4碼)</label>
                <input type="password" id="passInput" class="form-control" placeholder="請輸入手機末4碼">
            </div>
            <button onclick="search()" class="btn btn-primary w-100 py-2 fw-bold">立即查詢</button>

            <div id="resultArea" class="result-box">
                <div class="alert alert-success text-center py-1">查詢成功</div>
                <table class="table table-bordered">
                    <tr><th class="bg-light">姓名</th><td id="resName"></td></tr>
                    <tr><th class="bg-light">國文</th><td id="resChi"></td></tr>
                    <tr><th class="bg-light">數學</th><td id="resMat"></td></tr>
                    <tr><th class="bg-light">英文</th><td id="resEng"></td></tr>
                    <tr><th class="bg-light">總分</th><td id="resTotal" class="text-primary fw-bold"></td></tr>
                    <tr><th class="bg-light">排名</th><td id="resRank"></td></tr>
                </table>
            </div>
        </div>
    </div>
</div>

<script>
    function search() {
        const user = document.getElementById('userInput').value.trim();
        const pass = document.getElementById('passInput').value.trim();
        
        if(!user || !pass) { alert("請完整輸入內容"); return; }

        Papa.parse("data.csv", {
            download: true,
            header: true,
            skipEmptyLines: true,
            error: function(err) {
                alert("讀取 data.csv 失敗，請確認檔案是否存在於 GitHub 首頁。");
            },
            complete: function(results) {
                const data = results.data;
                const match = data.find(row => 
                    String(row['合併准考證號']).trim() === user && 
                    String(row['家長手機']).trim() === pass
                );

                if (match) {
                    document.getElementById('resName').innerText = match['學生姓名'];
                    document.getElementById('resChi').innerText = match['國文'];
                    document.getElementById('resMat').innerText = match['數學'];
                    document.getElementById('resEng').innerText = match['英文'];
                    document.getElementById('resTotal').innerText = match['總成績'];
                    document.getElementById('resRank').innerText = "第 " + match['排名'] + " 名";
                    document.getElementById('resultArea').style.display = 'block';
                } else {
                    alert("查無資料，請確認輸入是否正確。");
                }
            }
        });
    }
</script>
</body>
</html>
